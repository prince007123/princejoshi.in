<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Suraksha Setu</title>

  <!-- Tailwind (dev CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

  <style>
    #mobile-menu { transition: left 0.25s ease; }
    /* simple modal backdrop blur */
    .backdrop-blur { backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px); }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Top Bar -->
  <div class="bg-blue-900 text-white text-sm py-2 px-4 flex justify-between items-center">
    <div><i class="fas fa-phone-alt"></i> Emergency Toll-Free: <strong>1800-112-247</strong></div>
    <div class="flex items-center space-x-4">
      <div class="hidden sm:block"><i class="fas fa-envelope"></i> help@surakshasetu.in</div>
      <select class="bg-blue-800 text-white border-none rounded px-2 py-1">
        <option>English</option>
        <option>‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
      </select>
    </div>
  </div>

  <!-- Navbar -->
  <header class="bg-white shadow-md relative z-50">
    <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
      <div class="flex items-center space-x-2">
        <img src="https://cdn-icons-png.flaticon.com/512/854/854878.png" alt="logo" class="h-9 w-9">
        <h1 class="text-2xl font-bold text-blue-700">SurakshaSetu</h1>
      </div>

      <nav class="hidden md:flex space-x-8 font-semibold">
        <a href="#" class="hover:text-blue-700">Home</a>
        <a href="#about" class="hover:text-blue-700">About</a>
        <a href="#Modules" class="hover:text-blue-700">Modules</a>
        <a href="#Services" class="hover:text-blue-700">Services</a>
        <a href="#contact" class="hover:text-blue-700">Contact</a>
      </nav>
      

      <div class="flex items-center gap-3">
        <!-- Register button - visible on all sizes -->
        <button id="openRegisterBtn" class="hidden md:inline-block bg-sky-600 text-white px-4 py-2 rounded-full shadow hover:bg-sky-700">
          <i class="fa-solid fa-user-plus mr-2"></i> Register
        </button>

        <!-- Mobile: register icon near hamburger -->
        <button id="openRegisterBtnMobile" class="md:hidden text-blue-700 p-2">
          <i class="fa-solid fa-user-plus text-lg"></i>
        </button>

        <button id="menu-btn" class="md:hidden text-3xl text-blue-700 focus:outline-none">
          <i class="fa-solid fa-bars"></i>
        </button>
      </div>
    </div>

    <!-- Mobile overlay & menu -->
    <div id="overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40"></div>
    <div id="mobile-menu" class="fixed top-0 left-[-100%] w-2/3 sm:w-1/3 h-full bg-blue-900 text-white p-6 flex flex-col space-y-6 pt-16 z-50">
      <button id="close-btn" class="absolute top-4 right-4 text-3xl">
        <i class="fa-solid fa-xmark"></i>
      </button>
      <a href="#" class="hover:text-yellow-300">Home</a>
      <a href="#about" class="hover:text-yellow-300">About</a>
      <a href="#modules" class="hover:text-yellow-300">Modules</a>
      <a href="#services" class="hover:text-yellow-300">Services</a>
      <a href="#Contact" class="hover:text-yellow-300">Contact</a>
      <button id="mobile-register-in-menu" class="mt-6 bg-sky-600 text-white px-4 py-2 rounded">Register</button>
    </div>
  </header>

<!-- Hero Section -->
<section 
  class="relative min-h-[80vh] flex items-center justify-center bg-cover bg-center text-white" 
  style="background-image: url('https://images.unsplash.com/photo-1606761568499-6d2451b23c29?auto=format&fit=crop&w=1600&q=80');">

  <!-- Overlay -->
  <div class="absolute inset-0 bg-gradient-to-b from-black/80 via-black/60 to-blue-900/70"></div>

  <!-- Content -->
  <div class="relative z-10 text-center px-6 sm:px-10 md:px-20 max-w-3xl">
    <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold mb-4 leading-tight">
      Empowering Safety with <span class="text-blue-400">AI & Geo-Fencing</span>
    </h1>

    <p class="text-base sm:text-lg md:text-xl text-gray-200 mb-8 leading-relaxed">
      Suraksha Setu connects <span class="font-semibold">citizens, authorities, and emergency services</span> through a smart safety network that responds instantly when it matters most.
    </p>

    <a href="#about" 
       class="inline-block px-6 sm:px-8 py-3 sm:py-4 bg-blue-600 hover:bg-blue-700 rounded-full font-semibold text-sm sm:text-base md:text-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
      üöÄ Explore More
    </a>
  </div>

  <!-- Subtle floating circles for motion effect -->
  <div class="absolute top-12 left-8 w-16 h-16 bg-blue-400/20 rounded-full blur-2xl animate-pulse"></div>
  <div class="absolute bottom-10 right-8 w-20 h-20 bg-indigo-500/20 rounded-full blur-3xl animate-bounce"></div>
</section>

<!-- About Section -->
<section id="about" class="relative bg-gradient-to-br from-blue-50 to-indigo-100 py-16 px-6 md:px-20 overflow-hidden">
  <div class="max-w-6xl mx-auto text-center relative z-10">
    <h2 class="text-4xl md:text-5xl font-extrabold text-blue-700 mb-6 tracking-tight">
      About <span class="text-indigo-600">Suraksha Setu</span>
    </h2>
    <p class="text-gray-700 max-w-3xl mx-auto text-lg leading-relaxed mb-8">
      <span class="font-semibold text-blue-800">Suraksha Setu</span> is an advanced <span class="font-semibold">AI-powered Safety & Incident Response System</span> 
      designed to enhance security for tourists and citizens.  
      It integrates <span class="text-indigo-700 font-semibold">Geo-fencing, Real-time Alerts, and Blockchain</span> to provide 
      a transparent, tamper-proof, and intelligent safety network.
    </p>

    <div class="grid md:grid-cols-3 gap-8 mt-10 text-left">
      <!-- Card 1 -->
      <div class="bg-white p-6 rounded-2xl shadow-md hover:shadow-xl transition-shadow duration-300 border border-blue-100">
        <div class="text-blue-600 text-3xl mb-3">üß†</div>
        <h3 class="text-xl font-bold text-blue-700 mb-2">AI-Powered Detection</h3>
        <p class="text-gray-600 leading-relaxed">
          Smart AI algorithms detect unusual activities, trigger early alerts, and help prevent emergencies before they escalate.
        </p>
      </div>

      <!-- Card 2 -->
      <div class="bg-white p-6 rounded-2xl shadow-md hover:shadow-xl transition-shadow duration-300 border border-blue-100">
        <div class="text-blue-600 text-3xl mb-3">üåç</div>
        <h3 class="text-xl font-bold text-blue-700 mb-2">Geo-Fencing & Alerts</h3>
        <p class="text-gray-600 leading-relaxed">
          Real-time location tracking keeps users within safe zones. Automatic alerts are sent when someone enters restricted or dangerous areas.
        </p>
      </div>

      <!-- Card 3 -->
      <div class="bg-white p-6 rounded-2xl shadow-md hover:shadow-xl transition-shadow duration-300 border border-blue-100">
        <div class="text-blue-600 text-3xl mb-3">üîó</div>
        <h3 class="text-xl font-bold text-blue-700 mb-2">Blockchain Transparency</h3>
        <p class="text-gray-600 leading-relaxed">
          Every safety event is securely logged using blockchain, ensuring full transparency and preventing data manipulation.
        </p>
      </div>
    </div>

    <div class="mt-12">
      <a href="#geo-fence" 
         class="inline-block px-8 py-3 bg-blue-700 text-white rounded-xl shadow-md hover:bg-blue-800 transition-colors duration-300 font-semibold">
        Explore Geo-Fencing
      </a>
    </div>
  </div>

  <!-- Background Glow -->
  <div class="absolute inset-0 bg-[radial-gradient(circle_at_top_right,rgba(59,130,246,0.15),transparent_70%)]"></div>
</section>

<!-- üß© MODULES SECTION -->
<section id="Modules" class="min-h-screen flex flex-col justify-center items-center bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700 text-white px-6">
  <h2 class="text-4xl font-bold mb-4 text-yellow-300">Modules</h2>
  <p class="text-center max-w-3xl text-blue-100">
    Suraksha Setu ke core modules me IoT-based alert system, Geo-Fencing, and AI emergency detection include hain.  
    Ye sab milke ek integrated safety network banate hain jo real-time protection aur response ensure karta hai.
  </p>
</section>



  <!-- IoT / Panic Section -->
<section id="iot" class="relative bg-gradient-to-br from-blue-950 via-blue-800 to-blue-700 py-24 md:py-32 text-white overflow-hidden">
  <!-- Animated background glow -->
  <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(255,255,255,0.05)_0%,transparent_70%)] animate-pulse"></div>

  <div class="relative max-w-6xl mx-auto px-6 text-center z-10">
    <h2 class="text-4xl md:text-5xl font-extrabold mb-6 tracking-wide drop-shadow-lg">
      IoT-Powered Emergency Response System
    </h2>
    <p class="text-blue-100 max-w-3xl mx-auto mb-10 text-lg md:text-xl leading-relaxed">
      Your safety is our priority. With one tap, our system instantly alerts emergency responders and starts location tracking.
      Built with IoT + AI for real-time, smart rescue.
    </p>

    <!-- Panic Button -->
    <div class="flex flex-col items-center justify-center space-y-8">
      <div class="relative">
        <div class="absolute inset-0 bg-yellow-400 blur-3xl opacity-30 rounded-full animate-ping"></div>
        <button id="panicBtn"
          class="relative bg-yellow-400 hover:bg-yellow-500 text-blue-900 font-extrabold text-2xl px-12 py-6 rounded-full shadow-2xl transition-transform transform hover:scale-110 active:scale-95 flex items-center">
          <i class="fa-solid fa-triangle-exclamation mr-3 text-3xl"></i>
          Activate Safety Alert
        </button>
      </div>

      <div class="text-center">
        <div id="statusBox"
          class="text-base md:text-lg text-yellow-200 bg-white/10 px-6 py-3 rounded-full inline-block shadow-md backdrop-blur-sm">
          üü° Status: <span class="font-semibold">Idle</span>
        </div>
      </div>
    </div>

    <!-- Additional Info Section -->
    <div class="mt-16 grid md:grid-cols-3 gap-8 text-left">
      <div class="bg-white/10 p-6 rounded-2xl backdrop-blur-sm shadow-md hover:scale-105 transition-transform">
        <h3 class="text-xl font-semibold mb-2 text-yellow-300">1Ô∏è‚É£ IoT Panic Device</h3>
        <p class="text-blue-100 leading-relaxed">
          Integrated with IoT devices and wearables that can trigger the alert remotely, ensuring help even when the user can‚Äôt reach the phone.
        </p>
      </div>
      <div class="bg-white/10 p-6 rounded-2xl backdrop-blur-sm shadow-md hover:scale-105 transition-transform">
        <h3 class="text-xl font-semibold mb-2 text-yellow-300">2Ô∏è‚É£ AI Smart Detection</h3>
        <p class="text-blue-100 leading-relaxed">
          Detects unusual motion, fall, or sound patterns automatically ‚Äî initiating a pre-alert with 10-second cancel timer before final SOS.
        </p>
      </div>
      <div class="bg-white/10 p-6 rounded-2xl backdrop-blur-sm shadow-md hover:scale-105 transition-transform">
        <h3 class="text-xl font-semibold mb-2 text-yellow-300">3Ô∏è‚É£ Real-Time Response</h3>
        <p class="text-blue-100 leading-relaxed">
          Instantly shares live GPS coordinates and situation status to control rooms or emergency contacts through secure channels.
        </p>
      </div>
    </div>
  </div>

  <audio id="alarmSound" src="emergency-alarm-69780.mp3" preload="auto"></audio>
</section>

<!-- ‚öôÔ∏è SERVICES SECTION -->
<section id="Services" class="min-h-screen flex flex-col justify-center items-center bg-gradient-to-br from-purple-800 via-purple-700 to-indigo-700 text-white px-6">
  <h2 class="text-4xl font-bold mb-4 text-yellow-300">Services</h2>
  <p class="text-center max-w-3xl text-purple-100">
    Suraksha Setu tourists aur citizens ke liye 24/7 safety tracking, emergency notification,  
    aur AI-driven threat alerts provide karta hai ‚Äî taaki har journey safe aur connected rahe.
  </p>
</section>





  <section id="geo-fence" class="py-14 bg-gradient-to-br from-blue-50 to-blue-100">
  <div class="max-w-5xl mx-auto px-6 text-center">
    <h2 class="text-3xl md:text-4xl font-extrabold text-blue-700 mb-3 tracking-tight">
      üöß Geo-Fencing Zone
    </h2>
    <p class="mb-6 text-gray-700 text-lg">
      Stay within the <span class="font-semibold text-blue-800">safe area</span>.  
      If you move outside, an alert will be triggered automatically.
    </p>

    <div class="relative shadow-lg border border-blue-200 rounded-2xl overflow-hidden">
      <div id="map" class="w-full h-[400px] md:h-[500px] rounded-2xl"></div>

      <!-- Overlay Status -->
      <div class="absolute top-3 left-3 bg-white/90 backdrop-blur-md px-4 py-2 rounded-xl shadow-md text-left">
        <p id="geoStatus" class="text-sm font-medium text-gray-700">
          üìç Tracking your location...
        </p>
      </div>
    </div>

    <!-- Safety Status -->
    <div class="mt-6">
      <div id="statusBox"
           class="inline-block px-6 py-3 bg-green-100 text-green-800 font-semibold rounded-xl border border-green-200 transition-all duration-500">
        ‚úÖ You are inside the safe zone
      </div>
    </div>
  </div>
</section>

<!-- üìû CONTACT SECTION -->
<section id="Contact" class="min-h-screen flex flex-col justify-center items-center bg-gradient-to-br from-green-900 via-green-800 to-green-700 text-white px-6">
  <h2 class="text-4xl font-bold mb-4 text-yellow-300">Contact</h2>
  <p class="text-center max-w-3xl text-green-100 mb-6">
    For support or collaboration, reach out to us anytime.  
    We‚Äôre committed to making every tourist‚Äôs journey secure and worry-free.
  </p>
  <a href="mailto:suraksha.setu@gmail.com" class="bg-yellow-400 hover:bg-yellow-500 text-black font-semibold px-6 py-2 rounded-lg shadow-lg transition">
    Email Us
  </a>
</section>


<!-- üåç Dynamic Price Estimation Section -->
<section id="price-section" class="relative overflow-hidden py-16 px-6 bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700 text-white rounded-2xl shadow-2xl mt-10">
  <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1400&q=80')] bg-cover bg-center opacity-20"></div>
  <div class="relative max-w-4xl mx-auto text-center">
    
    <h2 class="text-4xl font-extrabold mb-6 tracking-wide">üí∞ Dynamic Price Estimation</h2>
    <p class="text-blue-100 mb-8 text-lg">Select your dream destination and get instant cab & hotel cost insights.</p>

    <div class="flex flex-col md:flex-row items-center justify-center gap-4">
      <select id="destination" class="w-64 bg-white/90 text-gray-800 font-semibold p-3 rounded-xl shadow-inner border border-gray-300 focus:ring-4 focus:ring-blue-300 transition duration-300 ease-in-out">
        <option value="">Select Destination</option>
      </select>
      <button id="checkPrice" class="px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white font-semibold rounded-xl shadow-lg transform hover:scale-105 transition duration-300 ease-in-out">
        Check Price
      </button>
    </div>

    <div id="result" class="mt-10 text-lg text-gray-200 font-medium"></div>
  </div>
</section>



<script>
  // üåç Load tourist data dynamically
  async function loadTouristData() {
    try {
      const res = await fetch("/tourist_data.json");
      const data = await res.json();

      const dropdown = document.getElementById("destination");
      data.forEach(item => {
        const opt = document.createElement("option");
        opt.value = item.location;
        opt.textContent = item.location;
        dropdown.appendChild(opt);
      });

      document.getElementById("checkPrice").addEventListener("click", () => {
        const loc = dropdown.value;
        if (!loc) return alert("‚ö†Ô∏è Please select a destination first!");
        showPrice(data, loc);
      });
    } catch (err) {
      console.error("‚ùå Error loading tourist data:", err);
    }
  }

  // üí∏ Dynamic Price Calculation Logic
  function showPrice(data, loc) {
    const today = new Date();
    const month = today.getMonth(); // 0-11
    const info = data.find(i => i.location === loc);

    if (!info) return alert("Location data not found");

    let multiplier = 1;
    if (info.peakMonths.includes(month)) multiplier = 1.5;
    else if (info.offMonths.includes(month)) multiplier = 0.8;

    const hotelPrice = Math.round(info.basePriceHotelPerNight * multiplier);
    const cabPrice = Math.round(info.basePriceCabPerKm * multiplier);

    const seasonType = info.peakMonths.includes(month)
      ? "üåû Peak Season"
      : info.offMonths.includes(month)
      ? "üçÇ Off Season"
      : "üå§Ô∏è Normal Season";

    document.getElementById("result").innerHTML = `
      <div class="mt-6 bg-white/10 backdrop-blur-lg border border-white/20 p-6 rounded-2xl shadow-xl text-left transition transform hover:scale-[1.02]">
        <p class="text-2xl font-bold text-white mb-2">${info.location}</p>
        <p class="text-blue-200 mb-3">${seasonType}</p>
        <div class="grid md:grid-cols-2 gap-4">
          <div class="bg-blue-600/40 rounded-xl p-4">
            <p class="text-lg font-semibold">üè® Hotel/Night</p>
            <p class="text-3xl font-bold">‚Çπ${hotelPrice}</p>
          </div>
          <div class="bg-blue-500/40 rounded-xl p-4">
            <p class="text-lg font-semibold">üöó Cab/Km</p>
            <p class="text-3xl font-bold">‚Çπ${cabPrice}</p>
          </div>
        </div>
        <p class="mt-4 text-blue-100 italic">"${info.notes}"</p>
      </div>
    `;
  }

  loadTouristData();
</script>


<!-- Footer -->
  <footer class="bg-gray-800 text-white pt-12 pb-6">
    <div class="max-w-7xl mx-auto px-6">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-8">
        <div>
          <h3 class="text-xl font-bold mb-4">Suraksha Setu</h3>
          <p class="text-gray-400 mb-4">Connecting citizens, authorities, and emergency services through intelligent safety technology.</p>
          <div class="flex space-x-4">
            <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-twitter"></i></a>
            <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-instagram"></i></a>
            <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-linkedin-in"></i></a>
          </div>
        </div>
        
        <div>
          <h3 class="text-lg font-bold mb-4">Quick Links</h3>
          <ul class="space-y-2">
            <li><a href="#" class="text-gray-400 hover:text-white transition">Home</a></li>
            <li><a href="#about" class="text-gray-400 hover:text-white transition">About Us</a></li>
            <li><a href="#features" class="text-gray-400 hover:text-white transition">Features</a></li>
            <li><a href="#services" class="text-gray-400 hover:text-white transition">Services</a></li>
            <li><a href="#contact" class="text-gray-400 hover:text-white transition">Contact</a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-lg font-bold mb-4">Services</h3>
          <ul class="space-y-2">
            <li><a href="#" class="text-gray-400 hover:text-white transition">Personal Safety</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Women Security</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Child Safety</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Senior Care</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Travel Safety</a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-lg font-bold mb-4">Contact Info</h3>
          <ul class="space-y-3">
            <li class="flex items-start">
              <i class="fas fa-map-marker-alt mt-1 mr-3 text-blue-400"></i>
              <span class="text-gray-400">Security Complex, Sector 18, Noida, UP 201301</span>
            </li>
            <li class="flex items-center">
              <i class="fas fa-phone-alt mr-3 text-blue-400"></i>
              <span class="text-gray-400">Emergency: 1800-112-247</span>
            </li>
            <li class="flex items-center">
              <i class="fas fa-envelope mr-3 text-blue-400"></i>
              <span class="text-gray-400">help@surakshasetu.in</span>
            </li>
          </ul>
        </div>
      </div>
      
      <div class="pt-8 border-t border-gray-700 text-center text-gray-400">
        <p>&copy; 2023 Suraksha Setu. All rights reserved. | <a href="#" class="hover:text-white transition">Privacy Policy</a> | <a href="#" class="hover:text-white transition">Terms of Service</a></p>
      </div>
    </div>
  </footer>

<!-- Register Modal -->
<div id="registerModal" class="fixed inset-0 hidden items-center justify-center z-50">
  <div class="absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300"></div>

  <div class="relative bg-white w-full max-w-md mx-4 rounded-2xl p-6 z-50 shadow-2xl transform scale-95 opacity-0 transition-all duration-300"
       id="registerBox">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-2xl font-bold text-blue-700">Create Your Account</h3>
      <button id="closeRegister" class="text-gray-500 hover:text-gray-700 text-2xl">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>

    <form id="registerForm" class="space-y-4">
      <div>
        <label class="block text-sm font-medium text-gray-700">Full Name</label>
        <input type="text" id="reg_name" required placeholder="Enter your name"
               class="mt-1 w-full border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500 focus:outline-none">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Email</label>
        <input type="email" id="reg_email" required placeholder="you@example.com"
               class="mt-1 w-full border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500 focus:outline-none">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Emergency Number</label>
        <input type="tel" id="reg_phone" required placeholder="+91 98xxxxxxxx"
               class="mt-1 w-full border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500 focus:outline-none">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Upload Photo</label>
        <input type="file" id="reg_photo" accept="image/*" required
               class="mt-1 w-full border-gray-300 rounded-lg p-1.5 bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:outline-none">
        <div id="photoPreview" class="mt-2 text-sm text-gray-500"></div>
      </div>

      <div class="flex gap-3 pt-2">
        <button type="submit"
                class="flex-1 bg-blue-600 text-white py-2 rounded-full font-semibold hover:bg-blue-700 transition">
          Register Now
        </button>
        <button type="button" id="btnGetLoc"
                class="bg-green-600 text-white px-4 py-2 rounded-full font-semibold hover:bg-green-700 transition">
          Allow Location
        </button>
      </div>
      <p id="regStatus" class="hidden text-green-600 font-semibold text-sm mt-2">‚úî Registered Successfully</p>
      <p id="regError" class="hidden text-red-600 font-semibold text-sm mt-2">‚ùå Error while registering</p>
    </form>
  </div>
</div>

<script>
// ===== Modal Open/Close Animation =====
const modal = document.getElementById('registerModal');
const box = document.getElementById('registerBox');
const openBtns = [document.getElementById('openRegisterBtn'), document.getElementById('openRegisterBtnMobile'), document.getElementById('mobile-register-in-menu')];


openBtns.forEach(btn => btn?.addEventListener('click', () => {
  modal.classList.remove('hidden');
  setTimeout(() => {
    box.classList.remove('scale-95', 'opacity-0');
    box.classList.add('scale-100', 'opacity-100');
  }, 20);
}));

closeBtn.addEventListener('click', () => {
  box.classList.add('scale-95', 'opacity-0');
  setTimeout(() => modal.classList.add('hidden'), 200);
});
</script>

  <!-- ==================== PANIC ALERT POPUP ==================== -->
<div id="panicPopup" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50">
  <div class="bg-white rounded-2xl p-6 text-center shadow-2xl max-w-sm w-[90%]">
    <h2 class="text-2xl font-bold text-red-600 mb-2">üö® Possible Emergency!</h2>
    <p id="countdownText" class="text-gray-700 text-lg mb-4">Sending alert in 10s...</p>
    <button id="cancelBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-full transition">Cancel Alert</button>
  </div>
</div>




<script>
// ==================== GLOBAL VARIABLES ====================
let alertTimer = null;
let countdown = 10;
let alertTriggered = false;

// ==================== MAIN ALERT FUNCTION ====================
function triggerPanic() {
  if (alertTriggered) return; // Avoid multiple triggers
  alertTriggered = true;

  const popup = document.getElementById("panicPopup");
  const countdownText = document.getElementById("countdownText");
  const cancelBtn = document.getElementById("cancelBtn");

  popup.classList.remove("hidden");
  countdown = 10;
  countdownText.textContent = `Sending alert in ${countdown}s...`;

  // Countdown logic
  alertTimer = setInterval(() => {
    countdown--;
    countdownText.textContent = `Sending alert in ${countdown}s...`;
    if (countdown <= 0) {
      clearInterval(alertTimer);
      popup.classList.add("hidden");
      sendFinalAlert(); // Actual alert
      alertTriggered = false;
    }
  }, 1000);

  // Cancel button logic
  cancelBtn.onclick = () => {
    clearInterval(alertTimer);
    popup.classList.add("hidden");
    alertTriggered = false;
    console.log("‚ùå Alert cancelled by user.");
  };
}

// ==================== FINAL ALERT FUNCTION ====================
function sendFinalAlert() {
  console.log("üö® Sending real alert to backend/email...");

  // Example API call ‚Äî replace with your real backend
  fetch("http://localhost:3000/send", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ message: "Emergency detected automatically!" }),
  })
    .then(res => res.json())
    .then(data => console.log("‚úÖ Alert sent successfully!", data))
    .catch(err => console.error("‚ùå Failed to send alert", err));
}

// ==================== 1Ô∏è‚É£ SHAKE DETECTION ====================
let lastX = 0, lastY = 0, lastZ = 0;
let shakeThreshold = 15;

window.addEventListener("devicemotion", (event) => {
  let x = event.accelerationIncludingGravity.x;
  let y = event.accelerationIncludingGravity.y;
  let z = event.accelerationIncludingGravity.z;

  let speed = Math.abs(x + y + z - lastX - lastY - lastZ);
  if (speed > shakeThreshold) {
    console.log("üì± Shake detected!");
    triggerPanic();
  }

  lastX = x;
  lastY = y;
  lastZ = z;
});

// ==================== 2Ô∏è‚É£ SPEED DROP DETECTION ====================
let lastSpeed = 0;
let speedDropThreshold = 40; // km/h

if (navigator.geolocation) {
  setInterval(() => {
    navigator.geolocation.getCurrentPosition((pos) => {
      let speed = (pos.coords.speed || 0) * 3.6; // convert m/s to km/h
      if (lastSpeed - speed > speedDropThreshold && lastSpeed > 60) {
        console.log("üí• Sudden speed drop detected!");
        triggerPanic();
      }
      lastSpeed = speed;
    });
  }, 5000);
}

// ==================== 3Ô∏è‚É£ LOUD SOUND DETECTION ====================
async function detectLoudSound() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    const audioContext = new AudioContext();
    const source = audioContext.createMediaStreamSource(stream);
    const analyser = audioContext.createAnalyser();
    source.connect(analyser);
    const data = new Uint8Array(analyser.fftSize);

    function checkVolume() {
      analyser.getByteTimeDomainData(data);
      let avg = data.reduce((a, b) => a + Math.abs(b - 128), 0) / data.length;
      if (avg > 80) { // Adjust sensitivity
        console.log("üé§ Loud sound detected!");
        triggerPanic();
      }
      requestAnimationFrame(checkVolume);
    }
    checkVolume();
  } catch (err) {
    console.warn("üéß Mic access denied or unavailable.", err);
  }
}
detectLoudSound();

// üî¥ Test shortcut: Press "T" key to simulate emergency
document.addEventListener("keydown", (e) => {
  if (e.key === "t" || e.key === "T") {
    console.log("‚ö° Manual Test Trigger (T pressed)");
    triggerPanic();
  }
});

</script>






<script>
async function sendMail() {
  const res = await fetch("http://localhost:3000/send", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      to: "your_other_email@gmail.com",
      subject: "Testing Gmail App Password",
      text: "If you received this email, setup is working perfectly!"
    })
  });

  const data = await res.json();
  console.log(data);
  alert("Mail sent successfully!");
}
</script>



  <!-- Scripts -->

  
  <script>
    /* CONFIG */
    const AUTHORITY_EMAIL = "uk05065020524@gmail.com";
    const FORMSUBMIT_ENDPOINT = (to) => `https://formsubmit.co/ajax/${encodeURIComponent(to)}`;

    /* NAV & MOBILE MENU */
    const menuBtn = document.getElementById("menu-btn");
    const mobileMenu = document.getElementById("mobile-menu");
    const closeBtn = document.getElementById("close-btn");
    const overlay = document.getElementById("overlay");
    menuBtn.addEventListener("click", () => { mobileMenu.style.left = "0"; overlay.classList.remove("hidden"); });
    closeBtn.addEventListener("click", () => { mobileMenu.style.left = "-100%"; overlay.classList.add("hidden"); });
    overlay.addEventListener("click", () => { mobileMenu.style.left = "-100%"; overlay.classList.add("hidden"); });

    // Open register buttons
    const openRegisterBtn = document.getElementById("openRegisterBtn");
    const openRegisterBtnMobile = document.getElementById("openRegisterBtnMobile");
    const mobileRegisterInMenu = document.getElementById("mobile-register-in-menu");
    const registerModal = document.getElementById("registerModal");
    const closeRegister = document.getElementById("closeRegister");

    function openModal() { registerModal.classList.remove("hidden"); registerModal.classList.add("flex"); }
    function closeModal() { registerModal.classList.add("hidden"); registerModal.classList.remove("flex"); }

    openRegisterBtn?.addEventListener("click", openModal);
    openRegisterBtnMobile?.addEventListener("click", openModal);
    mobileRegisterInMenu?.addEventListener("click", () => { openModal(); mobileMenu.style.left = "-100%"; overlay.classList.add("hidden"); });
    closeRegister.addEventListener("click", closeModal);

    // Elements for register form
    const regForm = document.getElementById("registerForm");
    const regName = document.getElementById("reg_name");
    const regEmail = document.getElementById("reg_email");
    const regPhone = document.getElementById("reg_phone");
    const regPhoto = document.getElementById("reg_photo");
    const photoPreview = document.getElementById("photoPreview");
    const regStatus = document.getElementById("regStatus");
    const regError = document.getElementById("regError");
    const btnGetLoc = document.getElementById("btnGetLoc");

    // Load existing saved data
    window.addEventListener("load", () => {
      const savedName = localStorage.getItem("su_name");
      const savedEmail = localStorage.getItem("su_email");
      const savedPhone = localStorage.getItem("su_phone");
      const savedPhotoPreview = localStorage.getItem("su_photo_preview");
      const savedLoc = localStorage.getItem("su_location_link");

      if (savedName) regName.value = savedName;
      if (savedEmail) regEmail.value = savedEmail;
      if (savedPhone) regPhone.value = savedPhone;
      if (savedPhotoPreview) photoPreview.innerHTML = `<img src="${savedPhotoPreview}" class="w-28 h-28 object-cover rounded-md mt-2">`;
      if (savedLoc) regStatus.textContent = "Location saved ‚úì";

      // show desktop-register button on small screens also as needed CSS hides it
      // (already handled)
    });

    // Photo preview when user selects
    regPhoto.addEventListener("change", (e) => {
      const f = e.target.files[0];
      if (!f) return;
      if (f.size > 6 * 1024 * 1024) {
        regError.textContent = "Photo too large (max ~6MB).";
        regError.classList.remove("hidden");
        return;
      }
      regError.classList.add("hidden");
      const reader = new FileReader();
      reader.onload = (ev) => {
        photoPreview.innerHTML = `<img src="${ev.target.result}" class="w-28 h-28 object-cover rounded-md mt-2">`;
        // Save preview base64 to localStorage
        localStorage.setItem("su_photo_preview", ev.target.result);
        localStorage.setItem("su_photo_name", f.name);
      };
      reader.readAsDataURL(f);
    });

    // Allow Location (in modal)
    btnGetLoc.addEventListener("click", () => {
      if (!navigator.geolocation) { alert("Geolocation not supported."); return; }
      btnGetLoc.textContent = "Getting location...";
      navigator.geolocation.getCurrentPosition((pos) => {
        const lat = pos.coords.latitude.toFixed(6);
        const lng = pos.coords.longitude.toFixed(6);
        const mapsLink = `https://www.google.com/maps/search/?api=1&query=${lat},${lng}`;
        localStorage.setItem("su_location", `${lat},${lng}`);
        localStorage.setItem("su_location_link", mapsLink);
        regStatus.textContent = "Location saved ‚úì";
        btnGetLoc.textContent = "Allow Location";
      }, (err) => {
        console.warn("Location error:", err);
        regError.classList.remove("hidden");
        regError.textContent = "Location denied or unavailable.";
        btnGetLoc.textContent = "Allow Location";
      }, { enableHighAccuracy: true, timeout: 10000 });
    });

    // Registration submit (photo mandatory)
    regForm.addEventListener("submit", (e) => {
      e.preventDefault();
      regError.classList.add("hidden");
      const name = regName.value.trim();
      const email = regEmail.value.trim().toLowerCase();
      const phone = regPhone.value.trim();

      if (!name || !email || !phone) {
        regError.classList.remove("hidden"); regError.textContent = "Please fill all fields.";
        return;
      }

      // ensure photo exists (either in input file or saved preview)
      const file = regPhoto.files && regPhoto.files[0];
      const preview = localStorage.getItem("su_photo_preview");
      if (!file && !preview) {
        regError.classList.remove("hidden"); regError.textContent = "Please upload your photo (mandatory).";
        return;
      }

      localStorage.setItem("su_name", name);
      localStorage.setItem("su_email", email);
      localStorage.setItem("su_phone", phone);
      regStatus.classList.remove("hidden");
      regStatus.textContent = "Saved ‚úì";

      // If we have a new file, store its preview (already stored on change) and keep file input as is.
      // We keep preview in localStorage for attaching if user reloads.

      setTimeout(() => {
        regStatus.classList.add("hidden");
        closeModal();
      }, 900);
    });

    /* Helper: dataURL -> Blob */
    function dataURLtoBlob(dataurl) {
      const arr = dataurl.split(',');
      const mime = arr[0].match(/:(.*?);/)[1];
      const bstr = atob(arr[1]);
      let n = bstr.length;
      const u8arr = new Uint8Array(n);
      while (n--) u8arr[n] = bstr.charCodeAt(n);
      return new Blob([u8arr], { type: mime });
    }

    /* PANIC BUTTON: collect saved data, location, attach photo, and send via FormSubmit */
    const panicBtn = document.getElementById("panicBtn");
    const alarmSound = document.getElementById("alarmSound");
    const statusBox = document.getElementById("statusBox");

    panicBtn.addEventListener("click", async () => {
      const name = localStorage.getItem("su_name") || "";
      const email = localStorage.getItem("su_email") || "";
      const phone = localStorage.getItem("su_phone") || "";
      const loc = localStorage.getItem("su_location") || "";
      const locLink = localStorage.getItem("su_location_link") || "";
      const photoPreview = localStorage.getItem("su_photo_preview") || "";
      const photoName = localStorage.getItem("su_photo_name") || "photo.jpg";

      if (!name || !email || !phone || !photoPreview) {
        alert("Please register first with mandatory photo (click Register).");
        return;
      }

      // play sound and animate
      alarmSound.currentTime = 0;
      alarmSound.play().catch(()=>{ /* ignore autoplay block */ });

      statusBox.textContent = "Sending alert...";
      panicBtn.disabled = true;
      panicBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i> Sending...';

      // Build message body
      const humanMsg = `Panic Alert triggered!\n\nName: ${name}\nRegistered Email: ${email}\nEmergency Contact: ${phone}\nLocation: ${locLink || loc || 'Not provided'}\n\nPlease respond immediately.`;

      // Prepare FormData for authority
      const fdAuth = new FormData();
      fdAuth.append("subject", "üö® Panic Alert ‚Äî Suraksha Setu");
      fdAuth.append("message", humanMsg);
      fdAuth.append("name", name);
      fdAuth.append("email", email);
      fdAuth.append("phone", phone);
      fdAuth.append("location", locLink || loc);

      // Attach photo: prefer file input file if still available, else use saved preview
      const fileInput = document.getElementById("reg_photo");
      if (fileInput && fileInput.files && fileInput.files[0]) {
        fdAuth.append("attachment", fileInput.files[0], fileInput.files[0].name);
      } else {
        // convert base64 preview to blob
        try {
          const blob = dataURLtoBlob(photoPreview);
          fdAuth.append("attachment", blob, photoName);
        } catch (e) {
          console.warn("Could not attach photo blob:", e);
        }
      }

      fdAuth.append("_captcha", "false");
      fdAuth.append("_template", "table");

      // send to authority
      try {
        const resAuth = await fetch(FORMSUBMIT_ENDPOINT(AUTHORITY_EMAIL), { method: "POST", body: fdAuth });
        if (!resAuth.ok) {
          const txt = await resAuth.text();
          console.error("Authority send failed:", resAuth.status, txt);
          alert("Failed to send to authority. They may need to verify FormSubmit link. Check console.");
          statusBox.textContent = "Failed to send";
          panicBtn.disabled = false;
          panicBtn.innerHTML = '<i class="fa-solid fa-bell mr-2"></i> Activate Safety Alert';
          return;
        }
        console.log("Authority send OK:", await resAuth.json());
      } catch (err) {
        console.error("Network error sending to authority:", err);
        alert("Network error while sending. Check console.");
        statusBox.textContent = "Network error";
        panicBtn.disabled = false;
        panicBtn.innerHTML = '<i class="fa-solid fa-bell mr-2"></i> Activate Safety Alert';
        return;
      }

      // send copy to user (optional copy)
      try {
        const fdUser = new FormData();
        fdUser.append("subject", "Copy of Panic Alert ‚Äî Suraksha Setu");
        fdUser.append("message", humanMsg);
        fdUser.append("name", name);
        fdUser.append("email", email);
        fdUser.append("phone", phone);
        fdUser.append("location", locLink || loc);
        // attach same photo
        if (fileInput && fileInput.files && fileInput.files[0]) {
          fdUser.append("attachment", fileInput.files[0], fileInput.files[0].name);
        } else {
          const blob2 = dataURLtoBlob(photoPreview);
          fdUser.append("attachment", blob2, photoName);
        }
        fdUser.append("_captcha", "false");
        fdUser.append("_template", "table");

        const resUser = await fetch(FORMSUBMIT_ENDPOINT(email), { method: "POST", body: fdUser });
        // note: FormSubmit will send verification to user email first time
        if (!resUser.ok) {
          console.warn("User copy failed (this may require verification):", resUser.status, await resUser.text());
        } else {
          console.log("User copy OK:", await resUser.json());
        }
      } catch (err) {
        console.warn("Failed sending user copy:", err);
      }

      // finished
      statusBox.textContent = "Alert sent ‚úì";
      alert("‚úÖ Panic alert sent to authority. A copy was attempted to your email.");
      panicBtn.disabled = false;
      panicBtn.innerHTML = '<i class="fa-solid fa-bell mr-2"></i> Activate Safety Alert';
    });
  </script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>/* ---------- GEO-FENCING SYSTEM ---------- */
const map = L.map("map").setView([28.6139, 77.2090], 14); // default Delhi

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  maxZoom: 19,
}).addTo(map);

// Define geofence center and radius (in meters)
const fenceCenter = [28.6139, 77.2090];
const fenceRadius = 300; // 300 meters

// Draw circle zone
const fenceCircle = L.circle(fenceCenter, {
  color: "blue",
  fillColor: "#00f3",
  fillOpacity: 0.3,
  radius: fenceRadius,
}).addTo(map);

// Marker for user
const userMarker = L.marker(fenceCenter).addTo(map);

const geoStatus = document.getElementById("geoStatus");

function getDistance(lat1, lon1, lat2, lon2) {
  const R = 6371000; // radius of Earth in meters
  const œÜ1 = (lat1 * Math.PI) / 180;
  const œÜ2 = (lat2 * Math.PI) / 180;
  const ŒîœÜ = ((lat2 - lat1) * Math.PI) / 180;
  const ŒîŒª = ((lon2 - lon1) * Math.PI) / 180;

  const a =
    Math.sin(ŒîœÜ / 2) ** 2 +
    Math.cos(œÜ1) * Math.cos(œÜ2) * Math.sin(ŒîŒª / 2) ** 2;
  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
}

let alertSent = false;

function checkGeoFence(lat, lon) {
  const dist = getDistance(lat, lon, fenceCenter[0], fenceCenter[1]);
  if (dist > fenceRadius && !alertSent) {
    geoStatus.textContent = "üö® Outside safe zone! Sending alert...";
    alertSent = true;

    // Trigger backend email
fetch("http://localhost:3000/send", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    to: "your_email@gmail.com",
    subject: "Test Alert",
    text: "GeoFence triggered!",
  }),
})
  .then((res) => res.json())
  .then((data) => console.log("‚úÖ Mail Response:", data))
  .catch((err) => console.error("‚ùå Fetch Error:", err));

  } else if (dist <= fenceRadius) {
    geoStatus.textContent = "‚úÖ Inside safe zone";
    alertSent = false;
  }
}

function trackLocation() {
  if (!navigator.geolocation) {
    geoStatus.textContent = "Geolocation not supported by your browser.";
    return;
  }
  navigator.geolocation.watchPosition(
    (pos) => {
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;
      userMarker.setLatLng([lat, lon]);
      map.panTo([lat, lon]);
      checkGeoFence(lat, lon);
    },
    (err) => {
      geoStatus.textContent = "Failed to access location.";
      console.error(err);
    },
    { enableHighAccuracy: true }
  );
}

trackLocation();
</script>

<script>
  // Initialize map
  let map, marker;
function initMap() {
  // Default location ‚Äî India center
  const india = { lat: 20.5937, lng: 78.9629 };
  const map = new google.maps.Map(document.getElementById("map"), {
    center: india,
    zoom: 6,
  });

  // ‚úÖ Load GeoJSON file (restricted zones)
  map.data.loadGeoJson("restricted_zones.geojson");

  // ‚úÖ Style: Red border + transparent inside
  map.data.setStyle({
    strokeColor: "red",      // üî¥ border color
    strokeWeight: 3,         // thickness of border
    fillColor: "#ff0000",    // red fill (optional)
    fillOpacity: 0.1,        // 0 = fully transparent, 1 = solid fill
  });

  // ‚úÖ (Optional) Show zone name on hover
  const infowindow = new google.maps.InfoWindow();
  map.data.addListener("mouseover", (event) => {
    const name = event.feature.getProperty("name") || "Restricted Zone";
    infowindow.setContent(`<b>${name}</b>`);
    infowindow.setPosition(event.latLng);
    infowindow.open(map);
  });
  map.data.addListener("mouseout", () => infowindow.close());
}


  // Get live location
  function getLocation() {
    if (!navigator.geolocation) {
      alert("Geolocation not supported by your browser.");
      return;
    }

    navigator.geolocation.getCurrentPosition(
      (pos) => {
        const lat = pos.coords.latitude;
        const lng = pos.coords.longitude;
        console.log("‚úÖ Current location:", lat, lng);

        // Update map
        const position = { lat, lng };
        map.setCenter(position);
        map.setZoom(14);
        marker.setPosition(position);
      },
      (err) => {
        console.error("‚ùå Location error:", err);
        alert("Failed to get live location: " + err.message);
      },
      { enableHighAccuracy: true, timeout: 10000 }
    );
  }
</script>






</body>
</html>
